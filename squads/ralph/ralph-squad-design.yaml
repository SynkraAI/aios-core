# Ralph Squad Blueprint
# Generated by: Craft (Squad Creator)
# Date: 2025-02-05
# Source: Verbal domain description + Ralph loop analysis

squad:
  name: ralph
  description: |
    Autonomous Development Loop Orchestrator - Implementa o conceito Ralph
    (context-fresh iterations) integrado com a intelig√™ncia do AIOS.
    Usa swarm de agentes especializados, scripts para economia de tokens,
    e mem√≥ria persistente em arquivos para manter contexto entre itera√ß√µes.
  domain: autonomous-development-orchestration
  version: 1.0.0

analysis:
  entities:
    - Loop de execu√ß√£o (itera√ß√µes com contexto limpo)
    - Progress tracking (mem√≥ria externa persistente)
    - Story/PRD (fonte de tarefas)
    - Agent swarm (orquestra√ß√£o multi-agente)
    - Context monitor (detec√ß√£o de context rot)
    - State management (persist√™ncia entre resets)
  workflows:
    - develop (loop aut√¥nomo principal)
    - report (relat√≥rio de progresso)
    - resume (retomada de execu√ß√£o)
    - status (estado r√°pido)
    - config (configura√ß√£o do loop)
  integrations:
    - Todas as skills AIOS (@dev, @qa, @architect, @pm, @po, @sm, @analyst, @devops, @data-engineer, @ux-design-expert)
    - Task tool (subagents com contexto fresco)
    - Git (commits autom√°ticos via script)
    - Decision recorder (j√° existente no AIOS)
    - Story/PRD system (j√° existente no AIOS)
  stakeholders:
    - Todos os usu√°rios AIOS

recommendations:
  agents:
    - id: ralph
      name: Ralph
      title: Autonomous Development Loop Orchestrator
      icon: "üîÑ"
      archetype: Executor
      zodiac: "‚ôà Aries"
      tone: determined
      role: |
        Orquestrador aut√¥nomo que executa stories/PRDs completas usando swarm
        de agentes AIOS. N√£o faz o trabalho diretamente - delega via Task tool
        para subagents com contexto fresco, mant√©m mem√≥ria em arquivos, e
        garante itera√ß√µes infinitas sem degrada√ß√£o de qualidade.
      commands:
        - name: develop
          args: "{story-id|prd-path} [yolo|interactive]"
          description: "Loop aut√¥nomo de desenvolvimento - executa at√© completar"
          visibility: [full, quick, key]
        - name: report
          args: "[--verbose]"
          description: "Relat√≥rio de progresso: tarefas, erros, learnings, m√©tricas"
          visibility: [full, quick, key]
        - name: resume
          description: "Retoma execu√ß√£o interrompida do ponto exato"
          visibility: [full, quick, key]
        - name: status
          description: "Estado r√°pido: itera√ß√£o, tarefa atual, contexto usado"
          visibility: [full, quick, key]
        - name: stop
          description: "Para o loop gracefully (salva estado antes)"
          visibility: [full, quick]
        - name: config
          args: "[key] [value]"
          description: "Configura√ß√µes: max_iterations, auto_commit, agents, mode"
          visibility: [full]
        - name: help
          description: "Mostra comandos dispon√≠veis"
          visibility: [full, quick, key]
        - name: exit
          description: "Sair do modo ralph"
          visibility: [full, quick, key]
      core_principles:
        - "NUNCA executar tarefas diretamente - SEMPRE delegar via Task tool (contexto fresco)"
        - "Mem√≥ria SEMPRE em arquivos, NUNCA confiar no contexto da conversa"
        - "Scripts para opera√ß√µes mec√¢nicas, tokens para decis√µes inteligentes"
        - "Finalizar tarefa atual antes de auto-reset"
        - "Cada subagent recebe: tarefa + learnings + instru√ß√µes do agente AIOS correto"
        - "Acesso a TODAS as skills AIOS para orquestra√ß√£o swarm"
      confidence: 0.95
      user_added: false
      user_modified: false

  tasks:
    - name: ralph-develop
      agent: ralph
      description: |
        Loop aut√¥nomo principal. L√™ story/PRD, identifica tarefas pendentes,
        delega para agentes especializados via Task tool (contexto fresco),
        tracked progresso em arquivos, auto-reset quando contexto pesado.
      entrada:
        - "story_id ou prd_path (fonte de tarefas)"
        - "mode: yolo|interactive (default: yolo)"
      saida:
        - "Story/PRD com todas tarefas [x]"
        - "progress.md atualizado"
        - "decision-log gerado"
        - "Commits git por tarefa"
      confidence: 0.96

    - name: ralph-report
      agent: ralph
      description: |
        Gera relat√≥rio detalhado do progresso: tarefas conclu√≠das vs pendentes,
        erros encontrados, learnings acumulados, m√©tricas de execu√ß√£o,
        decis√µes tomadas.
      entrada:
        - "--verbose (opcional, inclui detalhes de cada itera√ß√£o)"
      saida:
        - "Relat√≥rio formatado no terminal"
      confidence: 0.92

    - name: ralph-resume
      agent: ralph
      description: |
        Retoma execu√ß√£o interrompida. L√™ ralph-state.yaml para saber
        exatamente onde parou, carrega progress.md para learnings,
        e continua o loop do ponto exato.
      entrada:
        - "ralph-state.yaml (autom√°tico)"
      saida:
        - "Loop retomado do ponto de interrup√ß√£o"
      confidence: 0.90

    - name: ralph-status
      agent: ralph
      description: |
        Status r√°pido via script (m√≠nimo de tokens): itera√ß√£o atual,
        tarefa em andamento, % completo, pr√≥ximos passos.
      entrada: []
      saida:
        - "Status one-liner no terminal"
      confidence: 0.88

    - name: ralph-config
      agent: ralph
      description: |
        Configura√ß√µes do loop Ralph. Persiste em ralph-config.yaml.
      entrada:
        - "key: max_iterations|auto_commit|allowed_agents|mode|context_limit"
        - "value: valor a configurar"
      saida:
        - "ralph-config.yaml atualizado"
      confidence: 0.85

  scripts:
    - name: ralph-parser.js
      purpose: "Extrai pr√≥xima tarefa [ ], conta progresso, l√™ checkboxes do story/PRD"
    - name: ralph-state.js
      purpose: "Serializa/deserializa ralph-state.yaml (save/load estado do loop)"
    - name: ralph-progress.js
      purpose: "Append formatado no progress.md (learnings, erros, m√©tricas)"
    - name: ralph-context-monitor.js
      purpose: "Estima tokens usados na sess√£o, retorna flag de reset necess√°rio"

  template: custom
  config_mode: extend

  context_management:
    strategy: "dual-layer-fresh-context"
    layer_1_subagents:
      mechanism: "Task tool ‚Üí subagent com contexto 0"
      when: "Toda execu√ß√£o de tarefa"
      what_receives: "prompt completo + learnings + task AIOS"
      what_discards: "hist√≥rico de itera√ß√µes anteriores"
    layer_2_orchestrator_reset:
      mechanism: "Salva estado em arquivos ‚Üí instrui *resume"
      when: "Contexto do Ralph principal fica pesado (~80k tokens)"
      state_files:
        - "progress.md (learnings entre itera√ß√µes)"
        - "ralph-state.yaml (estado exato do loop)"
        - "story file (checkboxes [x]/[ ])"
        - "decision-log.md (decis√µes ADR format)"
    token_optimization:
      scripts_over_tokens: true
      estimated_savings: "~4-5k tokens por itera√ß√£o"

  swarm_orchestration:
    agent_selection:
      description: |
        Ralph analisa cada tarefa e decide qual agente AIOS √© o melhor:
        - Implementa√ß√£o de c√≥digo ‚Üí @dev
        - Testes e valida√ß√£o ‚Üí @qa
        - Decis√µes de arquitetura ‚Üí @architect
        - Cria√ß√£o de stories ‚Üí @pm/@sm
        - Database/ETL ‚Üí @data-engineer
        - UI/UX ‚Üí @ux-design-expert
        - Pesquisa ‚Üí @analyst
        - Git/Deploy ‚Üí @devops
      fallback: "@dev (default para tarefas n√£o-classificadas)"

metadata:
  created_at: "2025-02-05T00:00:00Z"
  source_docs:
    - "docs/sobre-ralph/Ralph Wiggum LOOP - Video N√ÉO USE RALPH NO CLAUDE CODE.md"
    - "docs/sobre-ralph/ralph (1).ps1"
    - "docs/sobre-ralph/ralph.sh"
    - ".aios-core/development/agents/aios-master.md"
    - ".aios-core/development/tasks/dev-develop-story.md"
  user_adjustments: 0
  overall_confidence: 0.91
  design_method: verbal-description
